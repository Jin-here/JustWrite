<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:aop="http://www.springframework.org/schema/aop" 
	   xsi:schemaLocation="http://www.springframework.org/schema/beans 
	   					   http://www.springframework.org/schema/beans/spring-beans.xsd
        				   http://www.springframework.org/schema/aop 
        				   http://www.springframework.org/schema/aop/spring-aop.xsd">
	
    <bean id="logManager" class="com.example.aspect.LogManager"></bean>
    
    <bean id="userDao" class="com.example.dao.UserDao"></bean>
    
    <bean id="thingDao" class="com.example.dao.ThingDao">
        <constructor-arg index="0" type="int">
            <value>1</value>
        </constructor-arg>
        <constructor-arg index="1" type="int">
            <value>1399</value>
        </constructor-arg>
    </bean>
   
    <!-- proxy-target-class
    	true:创建基于类的代理
    	false:创建基于接口的代理(默认) -->
    <aop:config proxy-target-class="false">
        <!-- <aop:pointcut expression="target(com.example.dao.Dao) and execution(* *(..))" id="log"/> -->
        
        <aop:pointcut expression="execution(* com.example.dao.*.*(..))" id="log"/>
        
        <!-- 前置增强 -->
        <aop:aspect ref="logManager">
            <aop:before method="addLogBefore" pointcut-ref="log"/>
        </aop:aspect>
        
        <!-- 不接受返回值的后置增强 -->
        <aop:aspect ref="logManager">
            <aop:after method="addLogAfter" pointcut-ref="log"/>
        </aop:aspect>
        
        <!-- 接收返回值的后置增强 -->
        <aop:aspect ref="logManager">
            <aop:after-returning method="getTip" returning="tip" pointcut-ref="log"/>
        </aop:aspect>
        
        <!-- Final增强 -->
        <aop:aspect ref="logManager">
            <aop:after method="addLogFinal" pointcut-ref="log"/>
        </aop:aspect>
        
        <!-- 抛出异常增强 -->
        <aop:aspect ref="logManager">
            <aop:after-throwing method="addLogAfterThrowning" pointcut-ref="log"/>
        </aop:aspect>
        
        <!-- 环绕增强 -->
        <!-- <aop:aspect ref="logManager">
            <aop:around method="addLogAround" pointcut-ref="log"/>
        </aop:aspect> -->
        
        <!-- 引介增强 -->
        <aop:aspect ref="logManager">
            <aop:declare-parents types-matching="com.example.dao.UserDao" 
                implement-interface="com.example.aspect.ExtraAdvice"
                default-impl="com.example.aspect.MyAdvice"/>
        </aop:aspect>
    </aop:config>
</beans>