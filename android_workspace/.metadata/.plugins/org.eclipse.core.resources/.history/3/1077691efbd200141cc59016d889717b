package com.example.util;

import com.example.activity.LoadActivity;
import com.example.avrilweibo.R;

import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.provider.Settings;
import android.widget.TextView;

public class Tools {
	public static boolean isNetworkAvailable(Context context){
		ConnectivityManager connectivityManager = (ConnectivityManager) context.getSystemService(context.CONNECTIVITY_SERVICE);
		if (connectivityManager != null){	
			NetworkInfo[] info = connectivityManager.getAllNetworkInfo();
			if (info != null){
				for (NetworkInfo network : info){
					if (network.getState() == NetworkInfo.State.CONNECTED){
						return true;//有可用网络就选择，没选择最优网络
					}
				}
			}			
		}
		return false;
	}
	
	public static void checkNetwork(final Context context){//防止匿名内部类的context消亡
		if (!isNetworkAvailable(context)){
			TextView msg = new TextView(context);
			msg.setText(R.string.load_msg_context);
			new AlertDialog.Builder(context)
				.setIcon(R.drawable.lufei)
				.setTitle(R.string.load_msg_title).setView(msg)
				.setPositiveButton("确定", new DialogInterface.OnClickListener() {
					
					@Override
					public void onClick(DialogInterface arg0, int arg1) {
						// TODO Auto-generated method stub
						context.startActivity(new Intent(Settings.ACTION_WIRELESS_SETTINGS));
					}
				}).show();
		}
		
	}
	
	
}
