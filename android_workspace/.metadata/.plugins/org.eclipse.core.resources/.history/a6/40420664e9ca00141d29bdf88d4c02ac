package com.example.broadcast;

import android.app.Activity;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.telephony.SmsMessage;

public class MyBroadcastReceiver extends BroadcastReceiver {

	@Override
	public void onReceive(Context context, Intent intent) {
		// TODO Auto-generated method stub
		SmsMessage[] messages = getMessagesFromIntent(intent);
		for (SmsMessage message : messages){
			String from = message.getOriginatingAddress();
			String content = message.getMessageBody();
			if (from.equals("10001")){
				Activity activity = (Activity)context;
			}
		}
	}

	private SmsMessage[] getMessagesFromIntent(Intent intent){
		Object[] messages = (Object[])intent.getSerializableExtra("pdus");
		byte[][] pduObjs = new byte[messages.length][];
		for (int i = 0;i < messages.length;i++){
			pduObjs[i] = (byte[]) messages[i];
		}
		byte[][] pdus = new byte[pduObjs.length][];
		int pduCount = pdus.length;
		SmsMessage[] msgs = new SmsMessage[pduCount];
		for (int i = 0;i < pduCount;i++){
			pdus[i] = pduObjs[i];
			msgs[i] = SmsMessage.createFromPdu(pdus[i]);
		}
		return msgs;
	}
}
